<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2487.6">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="ja"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;title&gt;人生のカウントダウン&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- Tailwind CSSをCDNで読み込み --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script src="https://cdn.tailwindcss.com"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;!-- フォントの指定 --&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&amp;display=swap" rel="stylesheet"&gt;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>/* グローバルなスタイリングとダークテーマ */</p>
<p class="p1"><span class="Apple-converted-space">        </span>body {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-family: 'Inter', sans-serif;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background: #0f172a; /* Slate-900 */</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #f8fafc; /* White */</p>
<p class="p1"><span class="Apple-converted-space">            </span>min-height: 100vh;</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: flex;</p>
<p class="p1"><span class="Apple-converted-space">            </span>justify-content: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>align-items: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 20px;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* メインコンテナのスタイリング */</p>
<p class="p1"><span class="Apple-converted-space">        </span>.card {</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #1e293b; /* Slate-800 */</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 2rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>max-width: 600px;</p>
<p class="p1"><span class="Apple-converted-space">            </span>width: 100%;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-top: 4px solid #3b82f6; /* Blue-500 */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* カウントダウン表示エリアのスタイル (分解表示用) */</p>
<p class="p1"><span class="Apple-converted-space">        </span>#breakdown-display {</p>
<p class="p1"><span class="Apple-converted-space">            </span>display: grid;</p>
<p class="p1"><span class="Apple-converted-space">            </span>grid-template-columns: repeat(2, 1fr);</p>
<p class="p1"><span class="Apple-converted-space">            </span>gap: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* 単一単位表示用 */</p>
<p class="p1"><span class="Apple-converted-space">        </span>#single-unit-display {</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 1.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>text-align: center;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #334155; /* Slate-700 */</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 2rem 1rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 0.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>border: 1px solid #475569;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.time-unit {</p>
<p class="p1"><span class="Apple-converted-space">            </span>padding: 1rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #334155; /* Slate-700 */</p>
<p class="p1"><span class="Apple-converted-space">            </span>border-radius: 0.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>transition: transform 0.2s;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.time-unit:hover {</p>
<p class="p1"><span class="Apple-converted-space">            </span>transform: translateY(-2px);</p>
<p class="p1"><span class="Apple-converted-space">            </span>background-color: #475569; /* Slate-600 */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.time-value {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 2.5rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-weight: 900;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #ef4444; /* Red-500 */</p>
<p class="p1"><span class="Apple-converted-space">            </span>line-height: 1;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>.time-label {</p>
<p class="p1"><span class="Apple-converted-space">            </span>font-size: 0.875rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #94a3b8; /* Slate-400 */</p>
<p class="p1"><span class="Apple-converted-space">            </span>margin-top: 0.5rem;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* 秒の表示を特に目立たせる */</p>
<p class="p1"><span class="Apple-converted-space">        </span>#seconds-value, #single-value {</p>
<p class="p1"><span class="Apple-converted-space">            </span>color: #facc15; /* Yellow-400 */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>#single-value {</p>
<p class="p1"><span class="Apple-converted-space">             </span>font-size: 3.5rem; /* 単一表示は大きく */</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/* モバイル対応（小さな画面では1列にする） */</p>
<p class="p1"><span class="Apple-converted-space">        </span>@media (max-width: 480px) {</p>
<p class="p1"><span class="Apple-converted-space">            </span>#breakdown-display {</p>
<p class="p1"><span class="Apple-converted-space">                </span>grid-template-columns: 1fr;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>.time-value {</p>
<p class="p1"><span class="Apple-converted-space">                </span>font-size: 2rem;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;div class="card"&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;h1 class="text-3xl font-extrabold text-center mb-6 text-blue-400"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>⏳ 人生のカウントダウン</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/h1&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- 入力フォーム --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="input-form"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;p class="text-gray-400 text-sm mb-4 text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>残りの人生を計算するために、情報を入力してください。</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/p&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label for="birthdate" class="block text-sm font-medium mb-1"&gt;あなたの誕生日&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="date" id="birthdate" class="w-full p-2 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-blue-500 focus:border-blue-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- 1. 性別の選択 (新しく追加) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label for="gender-select" class="block text-sm font-medium mb-1"&gt;あなたの性別&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;select id="gender-select" class="w-full p-2 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-blue-500 focus:border-blue-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;option value="CUSTOM"&gt;カスタム / 性別非公開&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;option value="MALE"&gt;男性&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;option value="FEMALE"&gt;女性&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- 2. カウントダウン対象の選択 (新しく追加) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="target-type-container" class="mb-4 hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                 </span>&lt;label for="type-select" class="block text-sm font-medium mb-1"&gt;カウントダウン対象 (種類)&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;select id="type-select" class="w-full p-2 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-blue-500 focus:border-blue-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;option value="LE"&gt;平均寿命 (Life Expectancy)&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;option value="HALE"&gt;健康寿命 (Healthy Life Expectancy)&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- カスタム寿命入力フィールド (性別がCUSTOMの場合に表示) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="custom-age-input-container" class="mb-6"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label for="custom-expected-age" class="block text-sm font-medium mb-1"&gt;カスタム寿命 (歳)&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;input type="number" id="custom-expected-age" value="80" min="1" max="120" class="w-full p-2 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-blue-500 focus:border-blue-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;button id="start-button" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 rounded-lg transition duration-200 shadow-lg"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>カウントダウン開始</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- カウントダウン結果表示エリア --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;div id="result-area" class="hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;p class="text-center text-lg mb-4 text-gray-300"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>あなたの**死亡予定日時**まで</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;span id="expiry-date-text" class="font-bold text-yellow-300"&gt;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>残りの時間：</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/p&gt;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- 単位選択ドロップダウンの追加 --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="mb-4"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;label for="display-unit-select" class="block text-sm font-medium mb-1"&gt;表示単位を選択&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;select id="display-unit-select" class="w-full p-2 rounded-lg bg-gray-700 border border-gray-600 text-white focus:ring-blue-500 focus:border-blue-500"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;option value="breakdown"&gt;分解表示 (年, 日, 時, 分, 秒)&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;option value="years"&gt;年&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;option value="days"&gt;日&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;option value="hours"&gt;時間&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;option value="minutes"&gt;分&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;option value="seconds"&gt;秒&lt;/option&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/select&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- 1. 分解表示エリア (デフォルト) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="breakdown-display"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="time-unit"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="years-value" class="time-value"&gt;00&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="time-label"&gt;年&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="time-unit"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="days-value" class="time-value"&gt;000&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="time-label"&gt;日&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="time-unit"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="hours-value" class="time-value"&gt;00&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="time-label"&gt;時間&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="time-unit"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="minutes-value" class="time-value"&gt;00&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="time-label"&gt;分&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div class="time-unit col-span-2 sm:col-span-1 mx-auto" style="min-width: 150px;"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div id="seconds-value" class="time-value"&gt;00&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;div class="time-label"&gt;秒&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;!-- 2. 単一単位表示エリア (非表示) --&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div id="single-unit-display" class="hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div id="single-value" class="time-value"&gt;0&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;div id="single-label" class="time-label text-xl mt-3"&gt;単位&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;div class="mt-6 text-center"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;button id="reset-button" class="bg-gray-700 hover:bg-gray-600 text-gray-300 font-semibold py-2 px-4 rounded-lg text-sm transition duration-200"&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>設定をリセット</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;!-- エラーメッセージ表示エリア --&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;p id="error-message" class="text-red-500 text-center mt-4 hidden"&gt;</p>
<p class="p1"><span class="Apple-converted-space">            </span>有効な誕生日と寿命を入力してください。</p>
<p class="p1"><span class="Apple-converted-space">        </span>&lt;/p&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;script&gt;</p>
<p class="p1"><span class="Apple-converted-space">        </span>// DOM要素</p>
<p class="p1"><span class="Apple-converted-space">        </span>const birthdateInput = document.getElementById('birthdate');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const genderSelect = document.getElementById('gender-select'); // 性別選択 (新しい要素)</p>
<p class="p1"><span class="Apple-converted-space">        </span>const typeSelect = document.getElementById('type-select'); // 種類選択 (新しい要素)</p>
<p class="p1"><span class="Apple-converted-space">        </span>const targetTypeContainer = document.getElementById('target-type-container'); // 種類選択のコンテナ (新しい要素)</p>
<p class="p1"><span class="Apple-converted-space">        </span>const customAgeInputContainer = document.getElementById('custom-age-input-container');<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>const customExpectedAgeInput = document.getElementById('custom-expected-age');<span class="Apple-converted-space"> </span></p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>const startButton = document.getElementById('start-button');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const resetButton = document.getElementById('reset-button');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const inputForm = document.getElementById('input-form');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const resultArea = document.getElementById('result-area');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const errorMessage = document.getElementById('error-message');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const expiryDateText = document.getElementById('expiry-date-text');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const displayUnitSelect = document.getElementById('display-unit-select');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// カウントダウン表示要素</p>
<p class="p1"><span class="Apple-converted-space">        </span>const breakdownDisplay = document.getElementById('breakdown-display');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const singleUnitDisplay = document.getElementById('single-unit-display');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const singleValue = document.getElementById('single-value');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const singleLabel = document.getElementById('single-label');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const yearsValue = document.getElementById('years-value');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const daysValue = document.getElementById('days-value');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const hoursValue = document.getElementById('hours-value');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const minutesValue = document.getElementById('minutes-value');</p>
<p class="p1"><span class="Apple-converted-space">        </span>const secondsValue = document.getElementById('seconds-value');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// 状態変数</p>
<p class="p1"><span class="Apple-converted-space">        </span>let countdownInterval;</p>
<p class="p1"><span class="Apple-converted-space">        </span>let expiryTimestamp = 0;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// 定数 (ミリ秒単位)</p>
<p class="p1"><span class="Apple-converted-space">        </span>const MS_PER_SECOND = 1000;</p>
<p class="p1"><span class="Apple-converted-space">        </span>const MS_PER_MINUTE = MS_PER_SECOND * 60;</p>
<p class="p1"><span class="Apple-converted-space">        </span>const MS_PER_HOUR = MS_PER_MINUTE * 60;</p>
<p class="p1"><span class="Apple-converted-space">        </span>const MS_PER_DAY = MS_PER_HOUR * 24;</p>
<p class="p1"><span class="Apple-converted-space">        </span>const DAYS_PER_YEAR = 365.25; // うるう年を考慮 (平均値)</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// 最新の厚生労働省データ (令和5年簡易生命表 &amp; 令和4年 健康寿命)</p>
<p class="p1"><span class="Apple-converted-space">        </span>const LIFE_DATA = {</p>
<p class="p1"><span class="Apple-converted-space">            </span>MALE: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>LE: 81.09,<span class="Apple-converted-space">  </span>// 平均寿命 (Life Expectancy, 2023年/2024年)</p>
<p class="p1"><span class="Apple-converted-space">                </span>HALE: 72.57 // 健康寿命 (Healthy Life Expectancy, 2022年)</p>
<p class="p1"><span class="Apple-converted-space">            </span>},</p>
<p class="p1"><span class="Apple-converted-space">            </span>FEMALE: {</p>
<p class="p1"><span class="Apple-converted-space">                </span>LE: 87.13,<span class="Apple-converted-space">  </span>// 平均寿命 (Life Expectancy, 2024年)</p>
<p class="p1"><span class="Apple-converted-space">                </span>HALE: 75.45 // 健康寿命 (Healthy Life Expectancy, 2022年)</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>};</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/**</p>
<p class="p1"><span class="Apple-converted-space">         </span>* 性別選択に応じて、寿命の種類ドロップダウンとカスタム入力フィールドの表示を切り替える</p>
<p class="p1"><span class="Apple-converted-space">         </span>*/</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateInputUI() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const selectedGender = genderSelect.value;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (selectedGender === 'CUSTOM') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>targetTypeContainer.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                </span>customAgeInputContainer.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>targetTypeContainer.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                </span>customAgeInputContainer.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// UIを更新した後、ストレージに保存されている場合は、カスタム年齢をデフォルト値に戻す</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (selectedGender === 'CUSTOM') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const savedCustomAge = localStorage.getItem('customExpectedAge');</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (savedCustomAge) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>customExpectedAgeInput.value = savedCustomAge;</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>customExpectedAgeInput.value = '80'; // デフォルト値</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/**</p>
<p class="p1"><span class="Apple-converted-space">         </span>* ローカルストレージから保存された設定を読み込み、フォームに設定する</p>
<p class="p1"><span class="Apple-converted-space">         </span>*/</p>
<p class="p1"><span class="Apple-converted-space">        </span>function loadSettings() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const savedBirthdate = localStorage.getItem('birthdate');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const savedGender = localStorage.getItem('genderSelect');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const savedType = localStorage.getItem('typeSelect');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const savedCustomAge = localStorage.getItem('customExpectedAge');</p>
<p class="p1"><span class="Apple-converted-space">            </span>const savedUnit = localStorage.getItem('displayUnit');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (savedBirthdate) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>birthdateInput.value = savedBirthdate;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (savedGender) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>genderSelect.value = savedGender;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (savedType) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>typeSelect.value = savedType;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (savedCustomAge) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>customExpectedAgeInput.value = savedCustomAge;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (savedUnit) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>displayUnitSelect.value = savedUnit;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// UIの表示/非表示を更新</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateInputUI();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 設定が揃っている場合、自動的にカウントダウンを開始</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (savedBirthdate &amp;&amp; (savedGender === 'CUSTOM' &amp;&amp; savedCustomAge || savedGender !== 'CUSTOM')) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>calculateAndStartCountdown();</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/**</p>
<p class="p1"><span class="Apple-converted-space">         </span>* カウントダウンの計算と表示を毎秒更新する</p>
<p class="p1"><span class="Apple-converted-space">         </span>*/</p>
<p class="p1"><span class="Apple-converted-space">        </span>function updateCountdown() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const now = new Date().getTime();</p>
<p class="p1"><span class="Apple-converted-space">            </span>let distance = expiryTimestamp - now;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const displayMode = displayUnitSelect.value;</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// UI表示の切り替え</p>
<p class="p1"><span class="Apple-converted-space">            </span>const isBreakdown = displayMode === 'breakdown';</p>
<p class="p1"><span class="Apple-converted-space">            </span>breakdownDisplay.classList.toggle('hidden', !isBreakdown);</p>
<p class="p1"><span class="Apple-converted-space">            </span>singleUnitDisplay.classList.toggle('hidden', isBreakdown);</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// カウントダウン終了</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (distance &lt; 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>clearInterval(countdownInterval);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const expiryDateStr = new Date(expiryTimestamp).toLocaleDateString('ja-JP', { year: 'numeric', month: 'long', day: 'numeric' });</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// 既に死亡予定日時を過ぎている場合の表示</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (isBreakdown) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>yearsValue.textContent = '00';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>daysValue.textContent = '000';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>hoursValue.textContent = '00';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>minutesValue.textContent = '00';</p>
<p class="p1"><span class="Apple-converted-space">                    </span>secondsValue.textContent = '00';</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>singleValue.textContent = '0';</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>document.getElementById('result-area').querySelector('p').innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">                    </span>あなたの**死亡予定日時** &lt;span class="font-bold text-yellow-300"&gt;${expiryDateStr}&lt;/span&gt; は、</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;span class="text-red-500 font-extrabold"&gt;既に過ぎました。&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>残りの時間：</p>
<p class="p1"><span class="Apple-converted-space">                </span>`;</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// --- 分解表示のロジック ---</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (isBreakdown) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>// expectedAgeを取得し、年数を計算するために再利用</p>
<p class="p1"><span class="Apple-converted-space">                </span>let expectedAge = getExpectedAge();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>const birthDate = new Date(birthdateInput.value);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>const currentAgeInYears = (now - birthDate.getTime()) / (MS_PER_DAY * DAYS_PER_YEAR);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const remainingYears = expectedAge - currentAgeInYears;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// 年 (小数点以下切り捨て)</p>
<p class="p1"><span class="Apple-converted-space">                </span>const years = Math.floor(remainingYears);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// 日数 (残りのミリ秒を全て日数に変換)</p>
<p class="p1"><span class="Apple-converted-space">                </span>const daysLeft = Math.floor(distance / MS_PER_DAY);</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>// 時間、分、秒の計算</p>
<p class="p1"><span class="Apple-converted-space">                </span>const hours = Math.floor((distance % MS_PER_DAY) / MS_PER_HOUR);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const minutes = Math.floor((distance % MS_PER_HOUR) / MS_PER_MINUTE);</p>
<p class="p1"><span class="Apple-converted-space">                </span>const seconds = Math.floor((distance % MS_PER_MINUTE) / MS_PER_SECOND);</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// DOMを更新 (ゼロパディング)</p>
<p class="p1"><span class="Apple-converted-space">                </span>yearsValue.textContent = Math.max(0, years).toString().padStart(2, '0');</p>
<p class="p1"><span class="Apple-converted-space">                </span>daysValue.textContent = daysLeft.toString().padStart(3, '0'); // 日数はトータル日数で表示</p>
<p class="p1"><span class="Apple-converted-space">                </span>hoursValue.textContent = hours.toString().padStart(2, '0');</p>
<p class="p1"><span class="Apple-converted-space">                </span>minutesValue.textContent = minutes.toString().padStart(2, '0');</p>
<p class="p1"><span class="Apple-converted-space">                </span>secondsValue.textContent = seconds.toString().padStart(2, '0');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>}<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// --- 単一単位表示のロジック ---</p>
<p class="p1"><span class="Apple-converted-space">            </span>else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>let totalValue;</p>
<p class="p1"><span class="Apple-converted-space">                </span>let unitLabel;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">                </span>switch (displayMode) {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'years':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>// 年は正確な日数を基準に計算 (うるう年考慮)</p>
<p class="p1"><span class="Apple-converted-space">                        </span>totalValue = distance / (MS_PER_DAY * DAYS_PER_YEAR);</p>
<p class="p1"><span class="Apple-converted-space">                        </span>unitLabel = '年 (概算)';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'days':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>totalValue = distance / MS_PER_DAY;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>unitLabel = '日';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'hours':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>totalValue = distance / MS_PER_HOUR;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>unitLabel = '時間';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'minutes':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>totalValue = distance / MS_PER_MINUTE;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>unitLabel = '分';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                    </span>case 'seconds':</p>
<p class="p1"><span class="Apple-converted-space">                        </span>totalValue = distance / MS_PER_SECOND;</p>
<p class="p1"><span class="Apple-converted-space">                        </span>unitLabel = '秒';</p>
<p class="p1"><span class="Apple-converted-space">                        </span>break;</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>// 単一の値は、秒/分/時間の場合は小数点以下なし、日/年の場合は小数点第3位まで</p>
<p class="p1"><span class="Apple-converted-space">                </span>if (displayMode === 'seconds' || displayMode === 'minutes' || displayMode === 'hours') {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>singleValue.textContent = Math.floor(totalValue).toLocaleString();</p>
<p class="p1"><span class="Apple-converted-space">                </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                    </span>singleValue.textContent = totalValue.toFixed(3).toLocaleString();</p>
<p class="p1"><span class="Apple-converted-space">                </span>}</p>
<p class="p2"><span class="Apple-converted-space">                </span></p>
<p class="p1"><span class="Apple-converted-space">                </span>singleLabel.textContent = `残りの${unitLabel}`;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 単位の変更を保存</p>
<p class="p1"><span class="Apple-converted-space">            </span>localStorage.setItem('displayUnit', displayMode);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/**</p>
<p class="p1"><span class="Apple-converted-space">         </span>* 現在の選択に基づいて、予想される寿命年齢を取得する</p>
<p class="p1"><span class="Apple-converted-space">         </span>* @returns {number} 予想寿命年齢</p>
<p class="p1"><span class="Apple-converted-space">         </span>*/</p>
<p class="p1"><span class="Apple-converted-space">        </span>function getExpectedAge() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>const selectedGender = genderSelect.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let expectedAge;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (selectedGender === 'CUSTOM') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>expectedAge = parseFloat(customExpectedAgeInput.value);</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                </span>const selectedType = typeSelect.value;</p>
<p class="p1"><span class="Apple-converted-space">                </span>expectedAge = LIFE_DATA[selectedGender][selectedType];</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p1"><span class="Apple-converted-space">            </span>return expectedAge;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/**</p>
<p class="p1"><span class="Apple-converted-space">         </span>* 入力値の検証を行い、カウントダウンを開始する</p>
<p class="p1"><span class="Apple-converted-space">         </span>*/</p>
<p class="p1"><span class="Apple-converted-space">        </span>function calculateAndStartCountdown() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>// 既存のインターバルをクリア</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (countdownInterval) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>clearInterval(countdownInterval);</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>const birthdateStr = birthdateInput.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const selectedGender = genderSelect.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>const selectedType = typeSelect.value;</p>
<p class="p1"><span class="Apple-converted-space">            </span>let expectedAge = getExpectedAge();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>if (!birthdateStr || isNaN(expectedAge) || expectedAge &lt;= 0) {</p>
<p class="p1"><span class="Apple-converted-space">                </span>errorMessage.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">                </span>return;</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>errorMessage.classList.add('hidden');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 1. 死亡予定日時を計算 (誕生日と予想寿命の時間を基準に)</p>
<p class="p1"><span class="Apple-converted-space">            </span>const birthDate = new Date(birthdateStr);</p>
<p class="p1"><span class="Apple-converted-space">            </span>// 予想寿命の年数を足した日付</p>
<p class="p1"><span class="Apple-converted-space">            </span>const expiryDate = new Date(birthDate.getFullYear() + expectedAge, birthDate.getMonth(), birthDate.getDate(), birthDate.getHours(), birthDate.getMinutes(), birthDate.getSeconds());</p>
<p class="p1"><span class="Apple-converted-space">            </span>expiryTimestamp = expiryDate.getTime();</p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 2. 設定をローカルストレージに保存</p>
<p class="p1"><span class="Apple-converted-space">            </span>localStorage.setItem('birthdate', birthdateStr);</p>
<p class="p1"><span class="Apple-converted-space">            </span>localStorage.setItem('genderSelect', selectedGender);</p>
<p class="p1"><span class="Apple-converted-space">            </span>localStorage.setItem('typeSelect', selectedType);</p>
<p class="p1"><span class="Apple-converted-space">            </span>if (selectedGender === 'CUSTOM') {</p>
<p class="p1"><span class="Apple-converted-space">                </span>localStorage.setItem('customExpectedAge', customExpectedAgeInput.value);</p>
<p class="p1"><span class="Apple-converted-space">            </span>} else {</p>
<p class="p1"><span class="Apple-converted-space">                 </span>localStorage.removeItem('customExpectedAge');</p>
<p class="p1"><span class="Apple-converted-space">            </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 3. UIを更新</p>
<p class="p1"><span class="Apple-converted-space">            </span>inputForm.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>resultArea.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>expiryDateText.textContent = expiryDate.toLocaleDateString('ja-JP', {</p>
<p class="p1"><span class="Apple-converted-space">                </span>year: 'numeric',</p>
<p class="p1"><span class="Apple-converted-space">                </span>month: 'long',</p>
<p class="p1"><span class="Apple-converted-space">                </span>day: 'numeric'</p>
<p class="p1"><span class="Apple-converted-space">            </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 4. カウントダウンを開始</p>
<p class="p1"><span class="Apple-converted-space">            </span>updateCountdown(); // 初回実行で即座に表示を更新</p>
<p class="p1"><span class="Apple-converted-space">            </span>countdownInterval = setInterval(updateCountdown, 1000);</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>/**</p>
<p class="p1"><span class="Apple-converted-space">         </span>* 設定をクリアし、入力フォームに戻る</p>
<p class="p1"><span class="Apple-converted-space">         </span>*/</p>
<p class="p1"><span class="Apple-converted-space">        </span>function resetSettings() {</p>
<p class="p1"><span class="Apple-converted-space">            </span>clearInterval(countdownInterval);</p>
<p class="p1"><span class="Apple-converted-space">            </span>localStorage.clear(); // 全ての設定をクリア</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">            </span>// UIをリセット</p>
<p class="p1"><span class="Apple-converted-space">            </span>inputForm.classList.remove('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>resultArea.classList.add('hidden');</p>
<p class="p1"><span class="Apple-converted-space">            </span>birthdateInput.value = '';</p>
<p class="p1"><span class="Apple-converted-space">            </span>genderSelect.value = 'CUSTOM';<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>typeSelect.value = 'LE';</p>
<p class="p1"><span class="Apple-converted-space">            </span>customExpectedAgeInput.value = '80';<span class="Apple-converted-space"> </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>updateInputUI(); // カスタム入力表示を確実に更新</p>
<p class="p1"><span class="Apple-converted-space">            </span>displayUnitSelect.value = 'breakdown';<span class="Apple-converted-space"> </span></p>
<p class="p2"><span class="Apple-converted-space">            </span></p>
<p class="p1"><span class="Apple-converted-space">            </span>// 結果エリアのテキストを元に戻す</p>
<p class="p1"><span class="Apple-converted-space">            </span>document.getElementById('result-area').querySelector('p').innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">                </span>あなたの**死亡予定日時**まで</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;span id="expiry-date-text" class="font-bold text-yellow-300"&gt;&lt;/span&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>&lt;br&gt;</p>
<p class="p1"><span class="Apple-converted-space">                </span>残りの時間：</p>
<p class="p1"><span class="Apple-converted-space">            </span>`;</p>
<p class="p1"><span class="Apple-converted-space">        </span>}</p>
<p class="p2"><br></p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">        </span>// --- イベントリスナー ---</p>
<p class="p1"><span class="Apple-converted-space">        </span>startButton.addEventListener('click', calculateAndStartCountdown);</p>
<p class="p1"><span class="Apple-converted-space">        </span>resetButton.addEventListener('click', resetSettings);</p>
<p class="p1"><span class="Apple-converted-space">        </span>displayUnitSelect.addEventListener('change', updateCountdown); // 単位変更時に更新</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// 性別選択時にUI表示を切り替える</p>
<p class="p1"><span class="Apple-converted-space">        </span>genderSelect.addEventListener('change', updateInputUI);</p>
<p class="p2"><span class="Apple-converted-space">        </span></p>
<p class="p1"><span class="Apple-converted-space">        </span>// ページロード時に設定を読み込む</p>
<p class="p1"><span class="Apple-converted-space">        </span>window.onload = loadSettings;</p>
<p class="p1"><span class="Apple-converted-space">    </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
